# schemats example in action

## Generating the type definition from schema

```
$ schemats generate -c postgres://crawldb:crawldb@localhost/crawldb -t \
   profile -t review -o crawldb.ts -n crawldb
```

The above will generate typescript interfaces for crawldb database 
with table profile and review. The resulting file is stored as crawldb.ts

## Writing code with typed schema

We can import crawldb.ts directly

```typescript
import {crawldb} from './crawldb'

// Now query with pg-promise and have a completely typed return value

let profileGoogleIds1: Array<crawldb.profile>
   = await db.query('SELECT * FROM profile WHERE google_place_id NOT NULL');


// You can decide to only get selected fields

let profileGoogleIds2: Array<{
    name: crawldb.profileFields.name,
    google_place_id: crawldb.profileFields.google_place_id
}> = await db.query('SELECT (name, google_place_id) FROM profile WHERE google_place_id NOT NULL');


// crawldb.profileFields.name is just a type alias to string
// Hence the one below also works

let profileGoogleIds3: Array<{
    name: string,
    google_place_id: string
}> = await db.query('SELECT (name, google_place_id) FROM profile WHERE google_place_id NOT NULL');



```

With the type definition in place, IntelliJ can help you with code completion
![](https://files.slack.com/files-pri/T043XKXFP-F20GL4BRC/screen_shot_2016-08-11_at_12.50.17_pm.png?pub_secret=8b093e1e31)
![](https://files.slack.com/files-pri/T043XKXFP-F20GU5TRT/screen_shot_2016-08-11_at_12.50.48_pm.png?pub_secret=75f4b4894b)


## Generating type definition

This type definition used above is automatically generated by schemats

```typescript

// File: crawldb.ts


export namespace crawldb {

    export namespace profileFields {
        export type unique_hash = string;
        export type uri = string;
        export type screenshot_uri = string;
        export type name = string;
        export type description = string;
        export type logo_uri = string;
        export type views = number;
        export type categories = string;
        export type likes = number;
        export type address = string;
        export type phone = string;
        export type email = string;
        export type postcal_code = string;
        export type website = string;
        export type is_closed = boolean;
        export type alternate_phones = string;
        export type fax = string;
        export type phone_toll_free = string;
        export type hours_of_operation = Object;
        export type enhanced_data = Object;
        export type created_at = Date;
        export type updated_at = Date;
        export type tokenized_address = string;
        export type normalized_address = Object;
        export type geo_lat = number;
        export type geo_long = number;
        export type fetch_counter = number;
        export type last_fetch_at = Date;
        export type formatted_address = string;
        export type components = Object;
        export type google_place_id = string;

    }

    export interface profile {
        unique_hash: profileFields.unique_hash;
        uri: profileFields.uri;
        screenshot_uri: profileFields.screenshot_uri;
        name: profileFields.name;
        description: profileFields.description;
        logo_uri: profileFields.logo_uri;
        views: profileFields.views;
        categories: profileFields.categories;
        likes: profileFields.likes;
        address: profileFields.address;
        phone: profileFields.phone;
        email: profileFields.email;
        postcal_code: profileFields.postcal_code;
        website: profileFields.website;
        is_closed: profileFields.is_closed;
        alternate_phones: profileFields.alternate_phones;
        fax: profileFields.fax;
        phone_toll_free: profileFields.phone_toll_free;
        hours_of_operation: profileFields.hours_of_operation;
        enhanced_data: profileFields.enhanced_data;
        created_at: profileFields.created_at;
        updated_at: profileFields.updated_at;
        tokenized_address: profileFields.tokenized_address;
        normalized_address: profileFields.normalized_address;
        geo_lat: profileFields.geo_lat;
        geo_long: profileFields.geo_long;
        fetch_counter: profileFields.fetch_counter;
        last_fetch_at: profileFields.last_fetch_at;
        formatted_address: profileFields.formatted_address;
        components: profileFields.components;
        google_place_id: profileFields.google_place_id;

    }

    export namespace reviewFields {
        export type review_id = string;
        export type unique_hash = string;
        export type domain = string;
        export type excerpt = string;
        export type author = string;
        export type author_id = string;
        export type rating = number;
        export type uri = string;
        export type date = Date;
        export type create_at = Date;

    }

    export interface review {
        review_id: reviewFields.review_id;
        unique_hash: reviewFields.unique_hash;
        domain: reviewFields.domain;
        excerpt: reviewFields.excerpt;
        author: reviewFields.author;
        author_id: reviewFields.author_id;
        rating: reviewFields.rating;
        uri: reviewFields.uri;
        date: reviewFields.date;
        create_at: reviewFields.create_at;

    }

}
```
